import{j as s,b as i,c as a,a7 as n}from"./chunks/framework.B0f4rbfy.js";const c=JSON.parse('{"title":"å°ç¨‹åºä¸­ä½¿ç”¨ lottie åŠ¨ç”» | è¸©å‘ç»éªŒåˆ†äº«","description":"è®°å½•åˆ†äº«åœ¨å°ç¨‹åºä¸­ä½¿ç”¨ lottie æ’­æ”¾AEåŠ¨ç”»çš„æ–¹æ³•ï¼Œä»¥åŠè¸©å‘ç»éªŒã€‚","frontmatter":{"tags":["æŠ€æœ¯ç¬”è®°","å°ç¨‹åº"],"description":"è®°å½•åˆ†äº«åœ¨å°ç¨‹åºä¸­ä½¿ç”¨ lottie æ’­æ”¾AEåŠ¨ç”»çš„æ–¹æ³•ï¼Œä»¥åŠè¸©å‘ç»éªŒã€‚"},"headers":[],"relativePath":"technology/learn/mini-lottie.md","filePath":"technology/learn/mini-lottie.md","lastUpdated":1716803856000}'),t={name:"technology/learn/mini-lottie.md"},h=n(`<h1 id="å°ç¨‹åºä¸­ä½¿ç”¨-lottie-åŠ¨ç”»-è¸©å‘ç»éªŒåˆ†äº«" tabindex="-1">å°ç¨‹åºä¸­ä½¿ç”¨ lottie åŠ¨ç”» | è¸©å‘ç»éªŒåˆ†äº« <a class="header-anchor" href="#å°ç¨‹åºä¸­ä½¿ç”¨-lottie-åŠ¨ç”»-è¸©å‘ç»éªŒåˆ†äº«" aria-label="Permalink to &quot;å°ç¨‹åºä¸­ä½¿ç”¨ lottie åŠ¨ç”» | è¸©å‘ç»éªŒåˆ†äº«&quot;">â€‹</a></h1><p>æœ¬å‘¨è¢«æ‹‰å»æ”¯æ´ç´§æ€¥éœ€æ±‚ï¼ˆèµ¶åœ¨äº”ä¸€èŠ‚å‡æ—¥å‰ä¸Šçº¿çš„ï¼ŒåŒä¼‘éœ€è¦åŠ ç­ğŸ˜±ï¼‰ï¼Œå‚ä¸åˆ°é¡¹ç›®ä¸­æ‰çŸ¥é“ï¼Œå¼€å‘çš„é¡¹ç›®æ˜¯å¾®ä¿¡å°ç¨‹åºæŠ€æœ¯æ ˆçš„ã€‚ç”±äºæ˜¯ä¸´æ—¶æ”¯æ´ï¼Œç¬”è€…ä¹Ÿå¾ˆä¹…æ²¡å¼€å‘è¿‡å¾®ä¿¡å°ç¨‹åºäº†ï¼Œæ‰€ä»¥æŒ‘é€‰äº†ç›¸å¯¹ç‹¬ç«‹ï¼Œä¸šåŠ¡å±æ€§ç›¸å¯¹è½»è–„çš„æ¨¡å—å‚ä¸ã€‚</p><p>å…¶ä¸­æœ‰ä¸ªè¥é”€æ´»åŠ¨ï¼ˆé¢†çº¢åŒ…ğŸ§§ğŸ˜ï¼‰çš„å¼¹çª—åŠ¨ç”»å°±è¦ç”¨åˆ° lottie åŠ¨ç”»ã€‚</p><p>æœ¬æ–‡å°±åˆ†äº«ä¸€ä¸‹åœ¨å°ç¨‹åºä¸­ä½¿ç”¨ lottie è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ä¸è§£å†³åŠæ³•ã€‚</p><h2 id="å…³äº-lottie" tabindex="-1">å…³äº lottie <a class="header-anchor" href="#å…³äº-lottie" aria-label="Permalink to &quot;å…³äº lottie&quot;">â€‹</a></h2><p><a href="https://airbnb.io/lottie/#/README" target="_blank" rel="noreferrer">lottie</a> æ˜¯ Airbnb å¼€æºçš„ä¸€ä¸ªåŠ¨ç”»åº“ï¼Œç”¨äºåœ¨ç«¯ä¸Šç›´æ¥æ’­æ”¾ AE ( Adobe After Effects)åŠ¨ç”»ã€‚</p><p>é€šè¿‡ <a href="https://github.com/airbnb/lottie-web/tree/master/build/extension" target="_blank" rel="noreferrer">bodymovin</a> AE æ’ä»¶å°†åŠ¨ç”»æ–‡ä»¶å¯¼å‡ºä¸º json æ–‡ä»¶ï¼Œlottie SDK é€šè¿‡å¯ä»¥é€šè¿‡ JSON æ–‡ä»¶ç›´æ¥æ’­æ”¾åŠ¨ç”»ã€‚</p><p>å…·ä½“ demos æ•ˆæœå¯ä»¥ä¸Š <a href="https://lottiefiles.com/" target="_blank" rel="noreferrer">LottieFiles</a> ç½‘ç«™æŸ¥çœ‹ã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨-ae-å¯¼å‡ºåŠ¨ç”»éœ€è¦çš„jsonæ–‡ä»¶" tabindex="-1">å¦‚ä½•ä½¿ç”¨ AE å¯¼å‡ºåŠ¨ç”»éœ€è¦çš„JSONæ–‡ä»¶ <a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨-ae-å¯¼å‡ºåŠ¨ç”»éœ€è¦çš„jsonæ–‡ä»¶" aria-label="Permalink to &quot;å¦‚ä½•ä½¿ç”¨ AE å¯¼å‡ºåŠ¨ç”»éœ€è¦çš„JSONæ–‡ä»¶&quot;">â€‹</a></h2><p>å®Œæˆ AE è½¯ä»¶å®‰è£…åï¼Œå‚ç…§ <a href="https://github.com/airbnb/lottie-web/tree/master?tab=readme-ov-file#plugin-installation" target="_blank" rel="noreferrer">Lottie Web GitHub å®˜æ–¹æ–‡æ¡£</a> å®Œæˆ <code>bodymovin</code> æ’ä»¶çš„å®‰è£…ã€‚</p><p>æ‰“å¼€åŠ¨ç”»æ–‡ä»¶åï¼Œåªéœ€ç®€å•å‡ æ­¥æ“ä½œ</p><p>â‘  window ä¸­é€‰æ‹© Bodymovie</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/e887b3af9200905af6a3484300de1d3b" alt="" loading="lazy"></p><p>â‘¡ é€‰æ‹©éœ€è¦å¯¼å‡ºçš„åŠ¨ç”»èµ„æº</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/ddb3ce4d7c88df65ee50cca915817fa7" alt="" loading="lazy"></p><p>â‘¢ å¯¼å‡ºé…ç½®ï¼ˆå°ç¨‹åºç›¸å…³ï¼‰</p><p>ç‚¹å‡»å¯¹åº”åŠ¨ç”»çš„è®¾ç½®</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/e8a6dfc08dd521ccf65cf2c003c00aac" alt="" loading="lazy"></p><p>å‹¾é€‰ <code>Glyphs</code> å°†ç”¨åˆ°çš„æ–‡å­—+å­—ä½“å¯¼å‡ºä¸ºå›¾å½¢ã€‚</p><p>å°ç¨‹åºé‡Œæ¸²æŸ“ä¸æ”¯æŒåŠ è½½å¤–éƒ¨å­—ä½“ã€‚</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/fab7f7d9ca8aafd9f7935afdb0d91b74" alt="" loading="lazy"></p><p><em>è¿™ä¸ªå°±ä¼šæœ‰ tree shakeçš„æ•ˆæœï¼Œå¦‚æœåŠ¨ç”»é‡Œæ²¡æœ‰ç”¨åˆ°çš„æ–‡å­—ï¼ŒåšåŠ¨æ€æ›¿æ¢çš„æ—¶å€™å°±ä¼šä¸æ˜¾ç¤ºï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»åˆ°</em>ã€‚</p><p>å‹¾é€‰ <code>Convert expressions to keyframes</code> å°†è¡¨è¾¾å¼è½¬ä¸ºå…³é”®å¸§ï¼Œå› ä¸ºå°ç¨‹åºé‡Œä¸æ”¯æŒä½¿ç”¨ <code>eval</code> ç­‰åŠ¨æ€æ‰§è¡Œè„šæœ¬çš„èƒ½åŠ›ã€‚</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/ca9d49f12f786b36cb1699958a56421e" alt="" loading="lazy"></p><p>ä¿®æ”¹å®Œæˆåç‚¹å‡»<code>Save</code>ä¿å­˜é…ç½®ã€‚</p><p>â‘£ æ¸²æŸ“å¯¼å‡º JSON æ–‡ä»¶</p><p>æœ€åç‚¹å‡» Render æŒ‰é’®ï¼Œå¯¼å‡º JSON æ–‡ä»¶ã€‚</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/e4e147a1d4a9a79b8d19f09bfc402bc0" alt="" loading="lazy"></p><p>å¯¼å‡ºæ–‡ä»¶å¦‚ä¸‹ï¼Œdata.json æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ JSON æ–‡ä»¶ï¼Œimages é‡Œå­˜å‚¨çš„å°±æ˜¯æ’­æ”¾è¦ç”¨åˆ°çš„å›¾ç‰‡æ–‡ä»¶ã€‚</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/58abc6bc9d72ed6d4ff078b58ab2dbaf" alt="" loading="lazy"></p><h2 id="å°ç¨‹åºä¸­ä½¿ç”¨" tabindex="-1">å°ç¨‹åºä¸­ä½¿ç”¨ <a class="header-anchor" href="#å°ç¨‹åºä¸­ä½¿ç”¨" aria-label="Permalink to &quot;å°ç¨‹åºä¸­ä½¿ç”¨&quot;">â€‹</a></h2><p>å¯ä»¥ä½¿ç”¨å°ç¨‹åºå®˜æ–¹å°è£…çš„ <a href="https://github.com/wechat-miniprogram/lottie-miniprogram" target="_blank" rel="noreferrer">lottie-miniprogram</a> åº“ã€‚</p><blockquote><p>å¿«é€ŸéªŒè¯çš„è¯å¯ä»¥æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œåœ¨ç‚¹å‡»ğŸ‘‰ğŸ» <a href="https://developers.weixin.qq.com/s/2TYvm9mJ75bF" target="_blank" rel="noreferrer">demoä»£ç ç‰‡æ®µ</a> è¿›è¡Œåˆ›å»ºã€‚</p></blockquote><p>â‘  å®‰è£…ä¾èµ–</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --save</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lottie-miniprogram</span></span></code></pre></div><p>â‘¡ ä½¿ç”¨</p><p><strong>tipï¼šå¼€å‘è€…å·¥å…·ä¸­éªŒè¯çš„è¯ï¼Œæ¸²æŸ“æ¨¡å¼éœ€è¦é€‰æ‹© webview ï¼Œ<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/skyline/introduction.html" target="_blank" rel="noreferrer">Skyline</a> ç›®å‰è¿˜ä¸æ”¯æŒè°ƒè¯• canvas</strong></p><p>index.wxml</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;lottie-canvas&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2d&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>index.js</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lottie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lottie-miniprogram&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Page</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onReady</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createSelectorQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#lottie-canvas&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å–å¾— canvas èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].node</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // è®¾ç½® cavnas ç”»å¸ƒå°ºå¯¸</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      lottie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> lottieInstance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lottie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        loop: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¾ªç¯æ’­æ”¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        autoplay: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è‡ªåŠ¨æ’­æ”¾</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æœ¬åœ°ä½¿ç”¨ http-server å¯åŠ¨æœåŠ¡åï¼ŒæŒ‡å®šæœ¬åœ°èµ„æºåœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        path: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://127.0.0.1:8080/lottie-demo-sources/data.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é€šè¿‡http åˆ¶å®šjsonèµ„æºè·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢è¿™ç§æ–¹å¼ï¼Œç›´æ¥ä¼ å…¥ lottie jsonå†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // (éœ€è¦åŠ¨æ€æ›¿æ¢æ–‡æ¡ˆå°±éœ€è¦ç”¨åˆ°è¿™ç§æ–¹å¼)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // animationData: {/* lottie json æ ¼å¼å†…å®¹ */},</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // é™æ€èµ„æºç›®å½•ï¼Œé€šå¸¸ä¸ animationData é…åˆä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // assetsPath: &#39;http://127.0.0.1:8080/lottie-demo-sources/images/&#39;,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        rendererSettings: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          context,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>æˆ‘è¿™ä¸ª demo çš„æ•ˆæœï¼ˆç½‘ä¸Šæ‰¾çš„åŠ¨ç”»ç´ æï¼‰å¦‚ä¸‹ã€‚</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/fe89db8f5a79940b2c2167062f1b321f" alt="" loading="lazy"></p><h2 id="é—®é¢˜-è§£å†³" tabindex="-1">é—®é¢˜&amp;è§£å†³ <a class="header-anchor" href="#é—®é¢˜-è§£å†³" aria-label="Permalink to &quot;é—®é¢˜&amp;è§£å†³&quot;">â€‹</a></h2><p>ä¸‹é¢ä»‹ç»åœ¨å®é™…ä¸šåŠ¡æ¥å…¥ä½¿ç”¨ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œè§£å†³åŠæ³•ã€‚</p><h3 id="expression-è¡¨è¾¾å¼" tabindex="-1">expression è¡¨è¾¾å¼ <a class="header-anchor" href="#expression-è¡¨è¾¾å¼" aria-label="Permalink to &quot;expression è¡¨è¾¾å¼&quot;">â€‹</a></h3><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼Œè¿™æ˜¯é‡åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ˆä¹Ÿæ˜¯ä¸Šé¢å¯¼å‡ºé…ç½®ä¸­æœ‰ç‰¹åˆ«è¯´æ˜çš„ï¼‰ã€‚</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/63b1e8a0370b0ffdd017de7ceb918465" alt="" loading="lazy"></p><p>ç»†çœ‹äº†ä¸€ä¸‹æ–‡æ¡£ï¼Œæœ‰ç‰¹åˆ«è¯´æ˜ï¼Œexpression è¡¨è¾¾å¼ç‰¹æ€§æ˜¯ä¸æ”¯æŒçš„ï¼Œå› æ­¤éœ€è¦å†å¯¼å‡º JSON æ–‡ä»¶æ—¶ç¦ç”¨ç›¸å…³ç‰¹æ€§ã€‚</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/c8f32eb3368a511c84cf1e7803687d5c" alt="" loading="lazy"></p><p>è§£å†³åŠæ³•ï¼šå¯¼å‡ºJSONæ–‡ä»¶æ—¶ï¼Œç¦ç”¨æ‰è¡¨è¾¾å¼ç‰¹æ€§å³å¯ã€‚</p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/60104c2927d61dcb75be50fbd363f45d" alt="" loading="lazy"></p><p>å½“ç„¶ç¦ç”¨åï¼ŒJSON æ–‡ä»¶å¤§å°ä¼šæœ‰æ‰€å¢åŠ ã€‚</p><p>æ¯”å¦‚æˆ‘è¿™ä¸ª demo ä» 40kb å¢åŠ åˆ°äº† 240kbï¼ˆå½“ç„¶åŠ¨ç”»ä¸ä¸€æ ·ï¼Œå¢é•¿çš„å¤§å°ä¼šæœ‰æ‰€ä¸åŒã€‚æœ‰äº›å‰åå¯èƒ½åªæœ‰1-2kbçš„å˜åŒ–ï¼‰ã€‚</p><h3 id="æ¨¡ç³Š" tabindex="-1">æ¨¡ç³Š <a class="header-anchor" href="#æ¨¡ç³Š" aria-label="Permalink to &quot;æ¨¡ç³Š&quot;">â€‹</a></h3><p>ç”±äºéœ€è¦å…¨å±å±•ç¤ºï¼ŒåŠ¨ç”»æ–‡ä»¶çš„å°ºå¯¸ä¸ç¡®å®šï¼Œæ‰‹åŠ¨åªè®¾ç½® canvas å°ºå¯¸ä¼šæœ‰æ¨¡ç³Šçš„é—®é¢˜ã€‚</p><p>è¿™ä¸ªé€šè¿‡æ˜é‡‘æœç´¢äº†ä¸€ä¸‹å°±å¾—åˆ°äº† <a href="https://juejin.cn/post/7171273016762974216#heading-7" target="_blank" rel="noreferrer">lottieåŠ¨ç”»æ¨¡ç³Šé—®é¢˜çš„è§£å†³æ–¹æ³•</a>ã€‚</p><p>å¾®è°ƒä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œå°±å¯ä»¥è§£å†³æ¨¡ç³Šé—®é¢˜ã€‚</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].node</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 600</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸‹é¢æ˜¯æ–°å¢çš„ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dpr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSystemInfoSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().pixelRatio</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dpr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dpr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scale</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dpr, dpr)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lottie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas)</span></span></code></pre></div><h3 id="å…¨å±åŠ¨ç”»" tabindex="-1">å…¨å±åŠ¨ç”» <a class="header-anchor" href="#å…¨å±åŠ¨ç”»" aria-label="Permalink to &quot;å…¨å±åŠ¨ç”»&quot;">â€‹</a></h3><p>å¼¹çª—çš„åŠ¨ç”»éœ€è¦å…¨å±å±•ç¤ºï¼Œå› æ­¤éœ€è¦è®¾ç½® <code>canvas</code> å®½é«˜ä¸ºé¡µé¢å®½é«˜ã€‚</p><p>index.wxss</p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">#lottie-canvas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    position</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fixed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    left</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    top</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">vw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">vh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>index.jsï¼Œä½¿ç”¨ <code>wx.getSystemInfoSync</code> è·å–è®¾å¤‡çš„ä¿¡æ¯</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">windowWidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">windowHeight</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pixelRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSystemInfoSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> windowWidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pixelRatio</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> windowHeight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pixelRatio</span></span></code></pre></div><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/3dd8a0483aba8a07d9a85692197e5ce5" alt="" loading="lazy"></p><h3 id="åŠ¨æ€æ–‡æ¡ˆ" tabindex="-1">åŠ¨æ€æ–‡æ¡ˆ <a class="header-anchor" href="#åŠ¨æ€æ–‡æ¡ˆ" aria-label="Permalink to &quot;åŠ¨æ€æ–‡æ¡ˆ&quot;">â€‹</a></h3><p>ç”±äºæ˜¯çº¢åŒ…ï¼Œéœ€è¦åŠ¨æ€å±•ç¤ºé‡‘é¢ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯ä¸å›ºå®šå†…å®¹çš„åŠ¨æ€æ ‡é¢˜ï¼‰ã€‚</p><p>æ€è·¯å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/102334701?s_r=0" target="_blank" rel="noreferrer">çŸ¥ä¹ï¼š åŠ¨æ€ä¿®æ”¹ Lottie ä¸­çš„æ–‡æœ¬</a></p><p>å¯ä»¥ä½¿ç”¨å›ºå®šæ ¼å¼çš„æ–‡æœ¬ <code>\${æ–‡æœ¬}</code> è¿›è¡Œæ›¿æ¢</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼ªä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sourceUrl&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> jsonText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.data</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> animationData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(jsonText.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;\${é‡‘é¢}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç›®æ ‡é‡‘é¢&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>æ¯”å¦‚æˆ‘åœ¨ demo é‡ŒåŠ ä¸€ä¸ªæ–‡å­—</p><ul><li>éœ€è¦å±•ç¤ºçš„æ–‡æœ¬é‡Œæ”¾å…¥ <code>\${num}</code> ç”¨äºæ›¿æ¢åŒ¹é…</li><li>åœ¨æ·»åŠ ä¸€ä¸ªæ–‡æœ¬è—åœ¨çœ‹ä¸è§çš„åœ°æ–¹,é‡Œé¢å†™å…¥æ›¿æ¢åéœ€è¦ç”¨åˆ°çš„æ–‡å­—ï¼ˆç¡®ä¿å’Œä¸Šé¢çš„æ–‡æœ¬ä¸ºåŒä¸€ç§å­—ä½“ï¼‰</li></ul><p><img src="https://cdn.upyun.sugarat.top/test/sugar/f2bd93aa21e7cd2328c987948d4557a7" alt="" loading="lazy"></p><p>æ¥ç€å¯¼å‡º JSON æ–‡ä»¶ã€‚</p><p>è°ƒç”¨æ–¹æ³•å¦‚ä¸‹</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ‹‰å–JSONæ–‡ä»¶å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> jsonData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://127.0.0.1:8080/json/text-replace/data.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res.data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// éšæœºç”Ÿæˆ1-100å…ƒçš„æ•°å­—ï¼Œä¿ç•™ä¸¤ä½å°æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">random</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toFixed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›¿æ¢å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> animationData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(jsonData)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">\\$\\{</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">num</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">\\}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}å…ƒ\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lottie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æŒ‡å®šjsonå†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  animationData,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // è®¾ç½®ä¾èµ–çš„å›¾ç‰‡èµ„æºä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  assetsPath: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://127.0.0.1:8080/json/text-replace/images/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...çœç•¥å…¶å®ƒé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>æ•ˆæœå¦‚ä¸‹</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/290fee264246526131c5048c67125711" alt="" loading="lazy"></p><h3 id="style-å¼•å‘çš„æ¸²æŸ“é”™è¯¯" tabindex="-1">style å¼•å‘çš„æ¸²æŸ“é”™è¯¯ <a class="header-anchor" href="#style-å¼•å‘çš„æ¸²æŸ“é”™è¯¯" aria-label="Permalink to &quot;style å¼•å‘çš„æ¸²æŸ“é”™è¯¯&quot;">â€‹</a></h3><p>åœ¨ canvas æ ‡ç­¾ä¸Šè®¾ç½® <code>display</code>æ§åˆ¶æ˜¾éšï¼Œå¶ç°ä¼šæç¤ºæ¸²æŸ“å±‚é”™è¯¯ã€‚</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;display:{{show?&#39;block&#39;:&#39;none&#39;}}&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;c1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2d&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/cedddb72f45046ca974cb594be964eeb" alt="" loading="lazy"></p><p>è§£å†³åŠæ³•ï¼Œç»™å¥—äº†ä¸€å±‚ <code>view</code>ï¼Œç”¨<code>wx:if</code>æ§åˆ¶å’¯ã€‚</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">view</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  wx:if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{show}}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;c1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2d&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">canvas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="ios-æ’­æ”¾é—ªé€€é—®é¢˜" tabindex="-1">iOS æ’­æ”¾é—ªé€€é—®é¢˜ <a class="header-anchor" href="#ios-æ’­æ”¾é—ªé€€é—®é¢˜" aria-label="Permalink to &quot;iOS æ’­æ”¾é—ªé€€é—®é¢˜&quot;">â€‹</a></h3><p>ç°è±¡æ˜¯ï¼Œéå†·å¯åŠ¨å°ç¨‹åºçš„æ—¶å€™ï¼ŒåŠ¨ç”»è¿˜æ²¡æ’­æ”¾å®Œæ¯•å°±æå‰ç»“æŸäº†ã€‚</p><p>çœ‹ä»£ç logï¼Œ3sçš„åŠ¨ç”»ï¼Œæ’­æ”¾ä¸åˆ° 1s å°±è§¦å‘äº† <code>complete</code> äº‹ä»¶ï¼Œçœ‹ç°è±¡å°±æ˜¯ä¸€é—ªè€Œé€ã€‚</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ani</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lottie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadAnimation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3s çš„åŠ¨ç”»</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  animationData,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...çœç•¥å…¶å®ƒé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ani.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;complete&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;åŠ¨ç”»æ’­æ”¾ç»“æŸ&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>é—®é¢˜æ’æŸ¥ï¼š</p><p>â‘  ç¿»çœ‹æºç <a href="https://github.com/wechat-miniprogram/lottie-miniprogram/tree/master" target="_blank" rel="noreferrer">lottie-miniprogram</a></p><p>åœ¨ <code>src/adapter/index.js</code> ä¸­çœ‹åˆ°<a href="https://github.com/wechat-miniprogram/lottie-miniprogram/blob/49066a6479d710b5863754613a518c65487912db/src/adapter/index.js#L89-L101" target="_blank" rel="noreferrer">ä¸‹é¢è¿™æ®µä»£ç </a></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestAnimationFrame</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> requestAnimationFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> called </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (called) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    called </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;function&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestAnimationFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">timeStamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (called) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    called </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;function&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(timeStamp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>åœ¨ç¿»çœ‹ä¸€ä¸‹å°ç¨‹åºæ–‡æ¡£é‡Œ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/canvas/Canvas.requestAnimationFrame.html" target="_blank" rel="noreferrer">canvas.requestAnimationFrame</a> æ–‡æ¡£è¯´æ˜ã€‚</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/36b0cfb5ce7dca2c6916caf71aeff2ff" alt="" loading="lazy"></p><p>æœ‰ç‚¹æ‚Ÿäº†ä¸Šé¢çš„ <code>setTimeout</code> ä»£ç ï¼Œåº”è¯¥æ˜¯ä¸ºäº†å…¼å®¹ä½ç‰ˆæœ¬çš„å°ç¨‹åºï¼Œé‡Œé¢è¿˜æœ‰ <code>called</code> å˜é‡æ§åˆ¶ï¼Œä¸é‡å¤æ‰§è¡Œã€‚</p><p>çŒœæµ‹å¯èƒ½æ˜¯åœ¨æ’­æ”¾çš„æ—¶å€™æ‰§è¡Œäº† <code>setTimeout</code> é‡Œçš„é€»è¾‘å¯¼è‡´åŠ¨ç”»æå‰ç»“æŸã€‚</p><p>äºæ˜¯æˆ‘å°±åŠ ä¸Šäº† <code>console.log</code> å‘å¸ƒåˆ°çº¿ä¸ŠéªŒè¯ä¸€ä¸‹ã€‚</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark has-diff vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (called) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  called </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;setTimeout&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;function&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestAnimationFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">timeStamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (called) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line diff add"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;canvas.requestAnimationFrame&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, timeStamp) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  called </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;function&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(timeStamp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>vconsole æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/8ee7e4cf3535cb2e4caba929abfe205c" alt="" loading="lazy"></p><p><em>ä¸€ç‚¹è¡¥å……ï¼Œé’ˆå¯¹ <code>canvas.requestAnimationFrame</code> å›åˆ°å‡½æ•°çš„å…¥å‚ï¼Œå°ç¨‹åºæ–‡æ¡£é‡Œè™½æ²¡æœ‰è¯¦ç»†ä»‹ç»ï¼Œä½†å¯ä»¥å¯¹æ ‡ Web çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/window/requestAnimationFrame" target="_blank" rel="noreferrer">Windowï¼šrequestAnimationFrame() æ–¹æ³•</a> çœ‹ä¸€ä¸‹ MDN ä¸Šçš„è§£é‡Šã€‚</em></p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/2d307758e0873a89aa4fb33602547ed7" alt="" loading="lazy"></p><p>ä»ä¸Šé¢çš„ <code>console</code> æ—¥å¿—çœ‹ï¼ŒåŸå› ç¡®å®æ˜¯æ‰§è¡Œ setTimeout é‡Œé¢çš„é€»è¾‘å¯¼è‡´çš„åŠ¨ç”»ç»“æŸã€‚</p><p>å¯ä»¥å¾—åˆ°å¼•å‘bugçš„åŸå› ï¼šâ†“</p><p><strong>æŸç§æƒ…å†µä¸‹ï¼Œ<code>setTimeout(callback, 100)</code> æ¯” <code>canvas.requestAnimationFrame</code> æ›´å¿«æ‰§è¡Œã€‚</strong></p><p><em>è¿™ä¸ªåº“å¾ˆä¹…æ²¡è¿­ä»£äº†ï¼ˆç°æœ‰ç‰ˆæœ¬æ˜¯3å¹´å‰å‘å¸ƒçš„ï¼‰ï¼Œæ¯å‘¨è¿˜æ˜¯æœ‰ä¸€äº›ä¸‹è½½é‡ï¼Œissue é‡Œä¹Ÿæ²¡æœ‰æåˆ° iOS æœ‰è¿™ä¸ªé—®é¢˜ï¼ï¼ˆåˆ‡æ¢æ¸²æŸ“æ¨¡å¼ä¸º skyline ä¹Ÿæ²¡æœ‰è§¦å‘è¿™ä¸ªé—®é¢˜ï¼Œé—®é¢˜åªåœ¨ webview æ¨¡å¼ä¸‹æœ‰ï¼Œä¸”ä»…ä½¿ç”¨ç®€å•Demoä¹Ÿæ— æ³•å¤ç°è¿™ä¸ªé—®é¢˜ï¼‰</em></p><p><em>ä¹Ÿä¸æ¸…æ¥šå°ç¨‹åºé‡Œ canvas.requestAnimationFrame å®ç°æœºåˆ¶ã€‚</em></p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/5c5a97df02d19c6b7248b1c983b5a639" alt="" loading="lazy"></p><p>å¤§èƒ†æ£æµ‹ä¸€ä¸‹åŸå› ï¼š</p><p><strong>é¡µé¢å®ç°å¯èƒ½è¿‡äºå¤æ‚ï¼Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘æ‰§è¡Œé˜»å¡åœ¨é€»è¾‘å±‚ï¼Œå¯¼è‡´ setTimeout æ—¶é—´åˆ°äº†ä»¥åå›è°ƒå‡½æ•°å…¥æ ˆï¼Œæ¥ç€å°±åœ¨é€»è¾‘å±‚è°ƒç”¨æ‰§è¡Œäº†</strong></p><p>è§£å†³åŠæ³•ï¼š</p><p><img src="https://cdn.upyun.sugarat.top/mdImg/sugar/182858ba4f246bf28417cda3fb029b8f" alt="" loading="lazy"></p><p><strong>æ—¢ç„¶æ˜¯å…¼å®¹å®ç°ï¼Œå°±åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ <code>requestAnimationFrame</code> æ–¹æ³•ï¼Œå­˜åœ¨å°±ä¸æ‰§è¡Œ <code>setTimeout</code> ç›¸å…³é€»è¾‘ã€‚</strong></p><p>å®Œæ•´è§£å†³ PR è§ï¼š<a href="https://github.com/wechat-miniprogram/lottie-miniprogram/pull/50" target="_blank" rel="noreferrer">https://github.com/wechat-miniprogram/lottie-miniprogram/pull/50</a></p><p>å°†æ‰“åŒ…åçš„äº§ç‰©æ›¿æ¢åˆ° <code>node_modules</code> é‡Œå¯¹åº”ä½ç½®åï¼Œå†ä½¿ç”¨ <a href="https://www.npmjs.com/package/patch-package" target="_blank" rel="noreferrer">patch-package</a> ç”Ÿæˆ patchï¼Œä»¥ä¾¿åç»­å®‰è£…ä¾èµ–è‡ªåŠ¨æ›´æ–°</p><h2 id="æœ€å" tabindex="-1">æœ€å <a class="header-anchor" href="#æœ€å" aria-label="Permalink to &quot;æœ€å&quot;">â€‹</a></h2><p>æ—¶é—´åŒ†å¿™ï¼Œä»‹ç»çš„ä¸æ˜¯éå¸¸çš„è¯¦ç»†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è¯„è®ºåŒºäº¤æµã€‚</p><p><code>demo</code> å®Œæ•´æºç è§ <a href="https://github.com/ATQQ/demos/tree/main/miniprogram/lottie-demo" target="_blank" rel="noreferrer">GitHubï¼šlottie-demo</a></p><p><img src="https://img.cdn.sugarat.top/mdImg/sugar/c5a59914529f4b50a969ec7f1caadc36" alt="" loading="lazy"></p>`,120),p=[h];function l(k,e,r,d,E,g){return i(),a("div",null,p)}const y=s(t,[["render",l]]);export{c as __pageData,y as default};
